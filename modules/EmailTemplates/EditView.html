<!--
/*********************************************************************************
 * The contents of this file are subject to the SugarCRM Public License Version
 * 1.1.3 ("License"); You may not use this file except in compliance with the
 * License. You may obtain a copy of the License at http://www.sugarcrm.com/SPL
 * Software distributed under the License is distributed on an "AS IS" basis,
 * WITHOUT WARRANTY OF ANY KIND, either express or implied.  See the License
 * for the specific language governing rights and limitations under the
 * License.
 *
 * All copies of the Covered Code must include on each user interface screen:
 *    (i) the "Powered by SugarCRM" logo and
 *    (ii) the SugarCRM copyright notice
 * in the same form as they appear in the distribution.  See full license for
 * requirements.
 *
 * The Original Code is: SugarCRM Open Source
 * The Initial Developer of the Original Code is SugarCRM, Inc.
 * Portions created by SugarCRM are Copyright (C) 2004-2006 SugarCRM, Inc.;
 * All Rights Reserved.
 * Contributor(s): ______________________________________.
 ********************************************************************************/
/*********************************************************************************
 * $Header: /var/cvsroot/sugarcrm/modules/EmailTemplates/EditView.html,v 1.36 2006/08/31 22:58:20 eddy Exp $
 ********************************************************************************/
-->
<!-- BEGIN: main -->
<style>
	#subjectfield { height: 1.6em; }
</style>

{JAVASCRIPT}
<script type="text/javascript" language="Javascript" src="modules/Emails/Email.js"></script>
<script type="text/javascript">
	{FIELD_DEFS_JS}
</script>

<table width="100%" cellpadding="0" cellspacing="0" border="0">
	<tr>
		<td style="padding-bottom: 2px;">
			<form name="EditView" method="POST" action="index.php" enctype="multipart/form-data">
			<input type="hidden" name="module" value="EmailTemplates">
			<input type="hidden" name="record" value="{ID}">
			<input type="hidden" name="action">
			<input type="hidden" name="form">
			<input type="hidden" name="return_module" value="{RETURN_MODULE}">
			<input type="hidden" name="return_id" value="{RETURN_ID}">
			<input type="hidden" name="return_action" value="{RETURN_ACTION}">
			<input type="hidden" name="inpopupwindow" value="{INPOPUPWINDOW}">
			<input type="hidden" name="old_id" value="{OLD_ID}">
		
			<input 	title="{APP.LBL_SAVE_BUTTON_TITLE}" 
					accessKey="{APP.LBL_SAVE_BUTTON_KEY}" 
					class="button" 
					onclick="this.form.action.value='Save'; return check_form('EditView');" 
					type="submit" 
					name="button" 
					value="  {APP.LBL_SAVE_BUTTON_LABEL}  " >
			<input	title="{APP.LBL_CANCEL_BUTTON_TITLE}" 
					accessKey="{APP.LBL_CANCEL_BUTTON_KEY}" 
					class="button" 
					onclick="{CANCEL_SCRIPT}" 
					type="submit" 
					name="button" 
					value="  {APP.LBL_CANCEL_BUTTON_LABEL}  ">
		</td>
		<td align="right" nowrap><span  class="required">{APP.LBL_REQUIRED_SYMBOL}</span> {APP.NTC_REQUIRED}</td>
		<td align='right'>{ADMIN_EDIT}</td>
	</tr>
</table>

<table width="100%" border="0" cellspacing="0" cellpadding="0"  class="tabForm">
	<tr>
		<td>
			<table width="100%" border="0" cellspacing="0" cellpadding="0">
				<tr>
					<td width="15%" class="dataLabel"><slot>{MOD.LBL_NAME} <span class="required">{APP.LBL_REQUIRED_SYMBOL}</span></slot></td>
					<td width="30%" class="dataField"><slot><input name='name' tabindex="10" type="text" size='30' maxlength="255" value="{NAME}"></slot></td>
					<td width="15%" class="dataLabel" align='right'><slot>



					</slot></td>
					<td width="30%" class="dataField"><slot>



					</slot></td>
				</tr>
				<tr>
					<td width="15%" class="dataLabel"><slot>{MOD.LBL_DESCRIPTION}</slot></td>
					<td colspan="3"  class="dataField"><slot><textarea name='description' tabindex='30' cols="90" rows="1"  style="height: 1.6.em; overflow-y:auto; font-family:sans-serif,monospace; font-size:inherit;" id="subjectfield">{DESCRIPTION}</textarea></td>
				</tr>
				<tr>
					<td colspan=4>&nbsp;</td>
				</tr>
				<tr>
					<td width="15%" class="dataLabel" align='left'>
						<slot>{MOD.LBL_INSERT_VARIABLE}&nbsp;</slot>
					</td>
					<td width="30%" class="dataField" colspan=3><slot>
						<select name='variable_module' tabindex="40" onChange="addVariables(document.EditView.variable_name,this.options[this.selectedIndex].value);">
							<!-- BEGIN: variable_option -->
							<option value="Accounts">{LBL_ACCOUNT}</option>
							<!-- END: variable_option -->
							<option value="Contacts">{MOD.LBL_CONTACT_AND_OTHERS}</option>
						</select>
						<select name='variable_name' tabindex="50" onChange="showVariable();">
						</select>
						<span class="dataLabel">{MOD.LBL_USE}:</span>
						<input type="text" size="30" tabindex="60" name="variable_text"/>
						<!-- BEGIN: variable_button -->
						<input type='button' tabindex="70" onclick='{INSERT_VARIABLE_ONCLICK}' class='button' value='{MOD.LBL_INSERT}'>
						<!-- END: variable_button -->
					</slot></td>
				</tr>
				<!-- BEGIN: tracker_url -->
				<tr>
					<td width="15%" class="dataLabel" align='left'>
						<slot>{MOD.LBL_INSERT_TRACKER_URL}&nbsp;</slot>
					</td >
					<td  width="85%" colspan=3 valign="top"  class="dataField">
						<slot><select tabindex='75' name='tracker_url' onChange='this.form.url_text.value=this.value'>{TRACKER_KEY_OPTIONS}</select><input type="text" size="30" id="url_text" name="url_text" value="{DEFAULT_URL_TEXT}"/>
						<input type='button' tabindex="77" onclick='{INSERT_URL_ONCLICK}' class='button' value='{MOD.LBL_INSERT_URL_REF}'>
					</slot></td>
				</tr>				
				<!-- END: tracker_url -->
				<tr>
					<td width="15%" class="dataLabel"><slot>{MOD.LBL_SUBJECT}</slot></td>
			        <td colspan='4' class="dataField"><slot><textarea onblur="remember_place(this);" name='subject' tabindex='80' cols="90" rows="1"  style="height: 1.6.em; overflow-y:auto; font-family:sans-serif,monospace; font-size:inherit;" id="subjectfield">{SUBJECT}</textarea></slot></td>
				</tr>
				<tr>
					<td valign="top" class="dataLabel"><slot>{MOD.LBL_BODY}</slot>
					</td>
					<!-- BEGIN: textarea -->
					<td colspan="4" class="dataField"><slot>
						<div id="html_div">
							<textarea tabindex='90' name='body_html' cols="100" rows="20">{BODY_HTML}</textarea>
						</div>
						<input onchange="toggle_textarea(this);" type="checkbox" name="toggle_html"> {MOD.LBL_EDIT_ALT_TEXT}<br>
						<div id="text_div" style="display: none">
							<textarea tabindex='100' name='body' cols="100" rows="20">{BODY}</textarea>
						</div>
					</slot></td>
					<!-- END: textarea -->
					<!-- BEGIN: htmlarea -->
			        <td colspan="4" class="dataField">
			         <slot>
			        	<div id="html_div">{HTMLAREA}</div>
						<input id='toggle_textarea_elem' onchange="toggle_textarea(this);" type="checkbox" name="toggle_html"/> {MOD.LBL_EDIT_ALT_TEXT}<br>
						<div id="text_div" style="display: none">
							<textarea tabindex='110' name='body' cols="100" rows="20">{BODY}</textarea>
						</div>
					 </slot>
					</td>
					<!-- END: htmlarea -->
				</tr>
				<tr>
					<td valign="top" class="dataLabel"><slot>{MOD.LBL_ATTACHMENTS}:</td>
					<td colspan="2" NOWRAP>
						{ATTACHMENTS_JAVASCRIPT}
						{ATTACHMENTS}
						<div id="uploads_div">
							<div style="display: none" id="file0"><input id = 'email_attachment0' name='email_attachment0' tabindex='120' size='40' type='file'/>&nbsp;<input type="button" onclick="deleteFile('0');" class="button" value="{APP.LBL_REMOVE}"/></div>
							<div style="display: none" id="file1"><input id = 'email_attachment1' name='email_attachment1' tabindex='130' size='40' type='file'/>&nbsp;<input type="button" onclick="deleteFile('1');" class="button" value="{APP.LBL_REMOVE}"/></div>
							<div style="display: none" id="file2"><input id = 'email_attachment2' name='email_attachment2' tabindex='140' size='40' type='file'/>&nbsp;<input type="button" onclick="deleteFile('2');" class="button" value="{APP.LBL_REMOVE}"/></div>
							<div style="display: none" id="file3"><input id = 'email_attachment3' name='email_attachment3' tabindex='150' size='40' type='file'/>&nbsp;<input type="button" onclick="deleteFile('3');" class="button" value="{APP.LBL_REMOVE}"/></div>
							<div style="display: none" id="file4"><input id = 'email_attachment4' name='email_attachment4' tabindex='160' size='40' type='file'/>&nbsp;<input type="button" onclick="deleteFile('4');" class="button" value="{APP.LBL_REMOVE}"/></div>
							<div style="display: none" id="file5"><input id = 'email_attachment5' name='email_attachment5' tabindex='170' size='40' type='file'/>&nbsp;<input type="button" onclick="deleteFile('5');" class="button" value="{APP.LBL_REMOVE}"/></div>
							<div style="display: none" id="file6"><input id = 'email_attachment6' name='email_attachment6' tabindex='180' size='40' type='file'/>&nbsp;<input type="button" onclick="deleteFile('6');" class="button" value="{APP.LBL_REMOVE}"/></div>
							<div style="display: none" id="file7"><input id = 'email_attachment7' name='email_attachment7' tabindex='190' size='40' type='file'/>&nbsp;<input type="button" onclick="deleteFile('7');" class="button" value="{APP.LBL_REMOVE}"/></div>
							<div style="display: none" id="file8"><input id = 'email_attachment8' name='email_attachment8' tabindex='200' size='40' type='file'/>&nbsp;<input type="button" onclick="deleteFile('8');" class="button" value="{APP.LBL_REMOVE}"/></div>
							<div style="display: none" id="file9"><input id = 'email_attachment9' name='email_attachment9' tabindex='210' size='40' type='file'/>&nbsp;<input type="button" onclick="deleteFile('9');" class="button" value="{APP.LBL_REMOVE}"/></div>
							
							<div style="display: none" id="document0"><input name='documentId0' id='documentId0' tabindex='0' type='hidden'/><input name='documentName0' id='documentName0' DISABLED size='40' type='text'/>&nbsp;<input type="button" onclick="selectDocument('0');" class="button" value="{APP.LBL_SELECT_BUTTON_LABEL}"/><input type="button" onclick="deleteDocument('0');" class="button" value="{APP.LBL_REMOVE}"/></div>
							<div style="display: none" id="document1"><input name='documentId1' id='documentId1' tabindex='1' type='hidden'/><input name='documentName1' id='documentName1' DISABLED size='40' type='text'/>&nbsp;<input type="button" onclick="selectDocument('1');" class="button" value="{APP.LBL_SELECT_BUTTON_LABEL}"/><input type="button" onclick="deleteDocument('1');" class="button" value="{APP.LBL_REMOVE}"/></div>
							<div style="display: none" id="document2"><input name='documentId2' id='documentId2' tabindex='2' type='hidden'/><input name='documentName2' id='documentName2' DISABLED size='40' type='text'/>&nbsp;<input type="button" onclick="selectDocument('2');" class="button" value="{APP.LBL_SELECT_BUTTON_LABEL}"/><input type="button" onclick="deleteDocument('2');" class="button" value="{APP.LBL_REMOVE}"/></div>
							<div style="display: none" id="document3"><input name='documentId3' id='documentId3' tabindex='3' type='hidden'/><input name='documentName3' id='documentName3' DISABLED size='40' type='text'/>&nbsp;<input type="button" onclick="selectDocument('3');" class="button" value="{APP.LBL_SELECT_BUTTON_LABEL}"/><input type="button" onclick="deleteDocument('3');" class="button" value="{APP.LBL_REMOVE}"/></div>
							<div style="display: none" id="document4"><input name='documentId4' id='documentId4' tabindex='4' type='hidden'/><input name='documentName4' id='documentName4' DISABLED size='40' type='text'/>&nbsp;<input type="button" onclick="selectDocument('4');" class="button" value="{APP.LBL_SELECT_BUTTON_LABEL}"/><input type="button" onclick="deleteDocument('4');" class="button" value="{APP.LBL_REMOVE}"/></div>
							<div style="display: none" id="document5"><input name='documentId5' id='documentId5' tabindex='5' type='hidden'/><input name='documentName5' id='documentName5' DISABLED size='40' type='text'/>&nbsp;<input type="button" onclick="selectDocument('5');" class="button" value="{APP.LBL_SELECT_BUTTON_LABEL}"/><input type="button" onclick="deleteDocument('5');" class="button" value="{APP.LBL_REMOVE}"/></div>
							<div style="display: none" id="document6"><input name='documentId6' id='documentId6' tabindex='6' type='hidden'/><input name='documentName6' id='documentName6' DISABLED size='40' type='text'/>&nbsp;<input type="button" onclick="selectDocument('6');" class="button" value="{APP.LBL_SELECT_BUTTON_LABEL}"/><input type="button" onclick="deleteDocument('6');" class="button" value="{APP.LBL_REMOVE}"/></div>
							<div style="display: none" id="document7"><input name='documentId7' id='documentId7' tabindex='7' type='hidden'/><input name='documentName7' id='documentName7' DISABLED size='40' type='text'/>&nbsp;<input type="button" onclick="selectDocument('7');" class="button" value="{APP.LBL_SELECT_BUTTON_LABEL}"/><input type="button" onclick="deleteDocument('7');" class="button" value="{APP.LBL_REMOVE}"/></div>
							<div style="display: none" id="document8"><input name='documentId8' id='documentId8' tabindex='8' type='hidden'/><input name='documentName8' id='documentName8' DISABLED size='40' type='text'/>&nbsp;<input type="button" onclick="selectDocument('8');" class="button" value="{APP.LBL_SELECT_BUTTON_LABEL}"/><input type="button" onclick="deleteDocument('8');" class="button" value="{APP.LBL_REMOVE}"/></div>
							<div style="display: none" id="document9"><input name='documentId9' id='documentId9' tabindex='9' type='hidden'/><input name='documentName9' id='documentName9' DISABLED size='40' type='text'/>&nbsp;<input type="button" onclick="selectDocument('9');" class="button" value="{APP.LBL_SELECT_BUTTON_LABEL}"/><input type="button" onclick="deleteDocument('9');" class="button" value="{APP.LBL_REMOVE}"/></div>
						</div>
						<input type="button" name="add_file_button" onclick="addFile();" value="{MOD.LBL_ADD_FILE}" class="button" />
						<input type="button" name="add_document_button" onclick="addDocument();" value="{MOD.LBL_ADD_DOCUMENT}" class="button" />
					</td>
				</tr>
			</table>
		</td>
	</tr>
</table>
</form>

<script type="text/javascript">
	var focus_obj = false;
	
	function remember_place(obj) {
	  focus_obj = obj;
	}
	
	
	
	function showVariable() {
		document.EditView.variable_text.value = 
			document.EditView.variable_name.options[document.EditView.variable_name.selectedIndex].value; 
	}
	
	function addVariables(the_select,the_module) {
		the_select.options.length = 0;
		for(var i=0;i<field_defs[the_module].length;i++) {
			var new_option = document.createElement("option");
			new_option.value = "$"+field_defs[the_module][i].name;
			new_option.text= field_defs[the_module][i].value
			the_select.options.add(new_option,i);
		}
		showVariable();
	}
	
	function toggle_textarea(obj) {
		if(obj.checked == true) {
			document.getElementById('text_div').style.display = 'block';
		} else {
			document.getElementById('text_div').style.display = 'none';
		}
	}
	
	function toggle_portal_flag() {
		{TOGGLE_JS}
	}
	
	addVariables(document.EditView.variable_name,'{DEFAULT_MODULE}');
	toggle_textarea( document.getElementById('toggle_textarea_elem'));
	focus_obj = document.EditView.body;
	toggle_portal_flag();
</script>
<!-- END: main -->
